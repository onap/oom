{
  "comments": [
    {
      "key": {
        "uuid": "db7c74c7_f508a7e4",
        "filename": "kubernetes/common/common/templates/_labels.tpl",
        "patchSetId": 1
      },
      "lineNbr": 29,
      "author": {
        "id": 511
      },
      "writtenOn": "2022-05-06T15:11:41Z",
      "side": 1,
      "message": "Does istio insist on a label called \"app\"?  Couldn\u0027t it use app.kubernetes.io/name?",
      "revId": "78994ae9f8231805051e5db0f0761ce38ec3c351",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1a4fe4b1_16bdd312",
        "filename": "kubernetes/common/common/templates/_labels.tpl",
        "patchSetId": 1
      },
      "lineNbr": 29,
      "author": {
        "id": 2679
      },
      "writtenOn": "2022-05-09T10:24:32Z",
      "side": 1,
      "message": "in my patch (https://gerrit.onap.org/r/c/oom/+/128371)\nI tried it in the \"matchLabels\" to use something different than \"app\" without success:\n\napiVersion: security.istio.io/v1beta1\nkind: PeerAuthentication\nmetadata:\n  name: {{ include \"common.servicename\" . }}\n  namespace: {{ include \"common.namespace\" . }}\nspec:\n  selector:\n    matchLabels:\n      app: {{ include \"common.servicename\" . }}\n  portLevelMtls:\n    {{ .Values.service.internalPort }}:\n      mode: DISABLE\n\nBut I will have to check, if the label \"app\" could only be used for \"service\" and not generally, as currently for some reason CPS has a problem.\nIt seems \"deployment\" definition has a problem with the label \"app\":\nroot@control01-istio:/opt/oom/kubernetes# helm upgrade -i onap-cps local/cps --namespace onap --version 10.0.0 --values /opt/oom/kubernetes/onap/resources/overrides/onap-all.yaml --values /opt/oom/kubernetes/onap/resources/overrides/environment.yaml --values /home/ubuntu/oom/master/onap-overrides.yaml --values /home/ubuntu/oom/master/onap-components.yaml --set config.useStrimziKafka\u003d\"true\" --timeout \u0027900s\u0027\nRelease \"onap-cps\" does not exist. Installing it now.\nError: Deployment.apps \"onap-ncmp-dmi-plugin\" is invalid: spec.template.metadata.labels: Invalid value: map[string]string{\"app.kubernetes.io/instance\":\"onap\", \"app.kubernetes.io/name\":\"ncmp-dmi-plugin\"}: `selector` does not match template `labels`",
      "parentUuid": "db7c74c7_f508a7e4",
      "revId": "78994ae9f8231805051e5db0f0761ce38ec3c351",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    }
  ]
}