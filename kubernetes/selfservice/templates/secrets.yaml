# An optional propery file for accessing the k8s by self service, for deployment, tiller etc.
# It is assumed to be prepared during boot strapping
# By default this is NOT required
# The content of the file should be a java properties format and should include the following keys
# username - the k8s username to use, for example kubernetes-admin
# token - the k8s token to use, for example as returned by:
# $ kubectl describe secret $(kubectl get secrets | grep default | cut -f1 -d ' ') | grep -E '^token' | cut -f2 -d':' | tr -d '\t'
# api_url - the k8s api url, for example https://10.247.88.15:6443
# Once you have this file, you may pass its base64 value, for example, if you placed the file at /root/k8s/access.props:
# helm install --set k8sAccessProps=`cat /root/k8s/access.props |base64 --wrap 0` -n aee-selfservice selfservice
apiVersion: v1
kind: Secret
metadata:
  name: k8s-api-secret
  namespace: {{ include "common.namespace" . }}
type: Opaque
data:
  access.props: {{ .Values.k8sAccessProps }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "common.namespace" . }}-ss-docker-registry-key
  namespace: {{ include "common.namespace" . }}
  labels:
    app: {{ include "common.name" . }}
    chart: {{ .Chart.Name }}-{{ .Chart.Version | replace "+" "_" }}
    release: {{ .Release.Name }}
    heritage: {{ .Release.Service }}
data:
  .dockercfg: {{ include "common.repository.secret" . }}
type: kubernetes.io/dockercfg


