{
  "comments": [
    {
      "key": {
        "uuid": "81533fdd_74b6fa18",
        "filename": "kubernetes/policy/components/policy-clamp-be/templates/deployment.yaml",
        "patchSetId": 6
      },
      "lineNbr": 70,
      "author": {
        "id": 4965
      },
      "writtenOn": "2021-05-05T13:52:53Z",
      "side": 1,
      "message": "Please don\u0027t use sed as we already had a bazillion issues with it. Please use envsubst which is way safer",
      "revId": "3c5a80fdb8b8898246dab4e6ec923a06458478b6",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8b13dbe1_673e2b75",
        "filename": "kubernetes/policy/components/policy-clamp-be/values.yaml",
        "patchSetId": 6
      },
      "lineNbr": 46,
      "author": {
        "id": 4965
      },
      "writtenOn": "2021-05-05T13:52:53Z",
      "side": 1,
      "message": "please use common secret template for this",
      "revId": "3c5a80fdb8b8898246dab4e6ec923a06458478b6",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d6350446_06aab58a",
        "filename": "kubernetes/policy/components/policy-clamp-be/values.yaml",
        "patchSetId": 6
      },
      "lineNbr": 46,
      "author": {
        "id": 23
      },
      "writtenOn": "2021-05-06T10:34:25Z",
      "side": 1,
      "message": "Not sure neither if it will be useful (unless i\u0027m mistaken), as the password should not be visible anywhere. It will obviously appear in the command executed in the AAF initiliazer, may be i missed it but i did not see those commands dumped somewhere\n\nMoreover i\u0027m not really sure how i can configure a secret for the certinit, as it\u0027s included in the deployment.yaml\nI have to create a new init container that has access to the certinit volume i think ...",
      "parentUuid": "8b13dbe1_673e2b75",
      "revId": "3c5a80fdb8b8898246dab4e6ec923a06458478b6",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fea49965_f8a34299",
        "filename": "kubernetes/policy/components/policy-clamp-be/values.yaml",
        "patchSetId": 6
      },
      "lineNbr": 46,
      "author": {
        "id": 4965
      },
      "writtenOn": "2021-05-06T22:29:02Z",
      "side": 1,
      "message": "Ok so let me explain the problem here. So the aaf_add_config is used as a content of the config map that is mounted to the init container created by the cerInitializer. Having any passwords in config map is strongly discouraged by kubernetes as those are stored in etcd in plain text and presented to every user on demand.\n\nIf we use common secret template here then the password will be stored in secret which can be encrypted at rest with the right k8s setup and the configmap woul just reference the env variable in which value (the actual password) is stored.\n\nDoing that in certInitializer would be tricky but you may always just add a separate init container that would do it for you and then just pass this password as env variable created from secret",
      "parentUuid": "d6350446_06aab58a",
      "revId": "3c5a80fdb8b8898246dab4e6ec923a06458478b6",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "174aa590_07349d59",
        "filename": "kubernetes/policy/components/policy-clamp-be/values.yaml",
        "patchSetId": 6
      },
      "lineNbr": 46,
      "author": {
        "id": 23
      },
      "writtenOn": "2021-05-07T05:54:25Z",
      "side": 1,
      "message": "Ok I see the problem, so I\u0027ll create a separate init container",
      "parentUuid": "fea49965_f8a34299",
      "revId": "3c5a80fdb8b8898246dab4e6ec923a06458478b6",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a",
      "unresolved": true
    }
  ]
}