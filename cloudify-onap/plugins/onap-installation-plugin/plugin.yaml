plugins:
  onap:
    executor: central_deployment_agent
    package_name: onap-installation-plugin
    package_version: '1.0.0'
    source: onap-installation-plugin
  #  install_arguments: '--process-dependency-links'

node_types:
  cloudify.onap.kubernetes.Environment:
    derived_from: cloudify.nodes.Root
    properties:
      namespace:
        type: string
      init_pod:
        type: string
        description: >
          Path to init pod chart
      openstack_envs:
        description: >
          ONAP parameters defined at the onap-parameters.yaml file
        default:
          OPENSTACK_UBUNTU_14_IMAGE: "Ubuntu 14.04.1 LTS Trusty Tahr"
          OPENSTACK_PUBLIC_NET_ID: "735c4398-a4cf-476b-b409-f50ce0dd6595"
          OPENSTACK_OAM_NETWORK_ID: "a985cd84-b860-4ed3-a4f4-67548d580e9c"
          OPENSTACK_OAM_SUBNET_ID: "7b72911e-a0a1-4221-9739-1fafe8a5a896"
          OPENSTACK_OAM_NETWORK_CIDR: "172.16.0.0/16"
          OPENSTACK_USERNAME: "marekw"
          OPENSTACK_API_KEY: "Aa123123"
          OPENSTACK_TENANT_NAME: "cloudify-cs"
          OPENSTACK_TENANT_ID: "47899782ed714295b1151681fdfd51f5"
          OPENSTACK_REGION: "RegionOne"
          OPENSTACK_KEYSTONE_URL: "http://192.168.120.10/identity/v3"
          OPENSTACK_FLAVOUR_MEDIUM: "m1.medium"
          OPENSTACK_SERVICE_TENANT_NAME: "cloudify-cs"
          DMAAP_TOPIC: "AUTO"
          DEMO_ARTIFACTS_VERSION: "1.1.0-SNAPSHOT"
      options:
        description: >
          For compatibility with kubernetes plugin.
          To be removed in the future.
        default: {}
    interfaces:
      cloudify.interfaces.lifecycle:
        create:
          implementation: onap.k8s_installer.environment.create_namespace
          executor: central_deployment_agent
        configure:
          implementation: onap.k8s_installer.environment.setup_helm_templates
          executor: central_deployment_agent
        start:
          implementation: onap.k8s_installer.environment.create_init_pod
          executor: central_deployment_agent
        stop:
          implementation: onap.k8s_installer.environment.delete_init_pod
          executor: central_deployment_agent
        delete:
          implementation: onap.k8s_installer.environment.delete_namespace
          executor: central_deployment_agent

  cloudify.onap.kubernetes.App:
    derived_from: cloudify.nodes.Root
    properties:
      name:
        type: string
        description: >
          Name of ONAP app
      path:
        type: string
        description: >
          Paths (relative, blueprint prespective) to app chart directory
        required: false
      options:
        description: >
          For compatibility with kubernetes plugin.
          To be removed in the future.
        default: {}
      ssh_credentials:
        description: >
          Workaround for docker secret settings
          via fabric plugin
        default:
          host_string: { get_secret: kubernetes_master_ip }
          user: { get_secret: agent_user }
          key: { get_secret: agent_key_private }
    interfaces:
      cloudify.interfaces.lifecycle:
        create:
          implementation: onap.k8s_installer.app.create_namespace
          executor: central_deployment_agent
        configure:
          implementation: onap.k8s_installer.app.configure_docker_secret
          executor: central_deployment_agent
        start:
          implementation: onap.k8s_installer.app.create_resources_services
          executor: central_deployment_agent
        stop:
          implementation: onap.k8s_installer.app.delete_resources_services
          executor: central_deployment_agent
        delete:
          implementation: onap.k8s_installer.app.delete_namespace
          executor: central_deployment_agent
